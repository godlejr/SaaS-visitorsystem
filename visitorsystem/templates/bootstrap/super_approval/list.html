{% extends "bootstrap/super_approval/base.html" %}

{% block mainContent %}
<!-- mainContent의 상단 조회조건 설정 부분 -->
<div class="mainContent-top">
    <div class="row gap-20 masonry pos-r" style=" height: 200px;">
        <div class="masonry-sizer col-md-12"></div>
        <div class="masonry-item col-md-12" style="position: absolute; left: 50%; top: 0px;">
            <!-- mainContent 최상단 : 페이지 명칭, 버튼 위치-->
            <div class="bgc-white bd p-20 mR-30">
                <div class="mT-10">
                    <!-- 각 입력값 ID 테이블컬럼명에 맞게 수정 필요 name부분 -->
                    <form id="superApprovalSearchForm" method="POST" action="{{ url_for('super_approval.index') }}">
                        <div class="content-top mB-10">
                            <div class="page-header"><h5 class="c-grey-900"> 감독부서업무 > 감독부서 승인 </h5></div>
                            <button type="submit" class="btn cur-p btn-primary mB-10 mR-10 btn-right search-btn" id = "searchBtn">조회</button>
                        </div>
                        <br/>
                        <hr/>
                        <div class="form-row">
                            <div class="form-group col-md-4"><label class="fw-500">신청일자</label>
                                <div class="timepicker-input input-icon form-group">
                                    <div class="input-group">
                                        <input type="text" class="form-control bdc-grey-200 startDate"
                                               data-provide="datepicker" name="visit_sdate" id="visit_sdate">

                                        <div class="input-group-addon bgc-white bd bdwR-0"><i class="ti-calendar"></i>
                                        </div>
                                        <h6 class="c-grey-900"> &nbsp~&nbsp</h6>

                                        <input type="text" class="form-control bdc-grey-200 ml-20 endDate"
                                               data-provide="datepicker" name="visit_edate" id="visit_edate"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group col-md-2"><label for="type">방문유형</label>
                                <select id="type" class="form-control" name="visit_category">
                                    <!-- type1 / type2 / type3 -->
                                    <option selected="selected" value="all">-전체-</option>
                                    {% for list in visitCategory %}
                                        <option name="{{list.code_nm}}">{{list.code_nm}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-3"><label for="visit-purpose">작업명</label> <input type="text"
                                                                                                       class="form-control"
                                                                                                       id="visit-purpose"
                                                                                                       name="visit_purpose">
                            </div>
                            <div class="form-group col-md-3"><label for="comp-nm">업체명</label> <input type="text"
                                                                                                           class="form-control"
                                                                                                           id="comp-nm"
                                                                                                           name="comp_nm">
                            </div>
                            <div class="form-group col-md-2"><label for="inputState">진행상태</label>
                                <select id="inputState" class="form-control" name="approval_state">
                                    <!-- all / state0 / state1 / state2-->
                                    <option selected="selected" value="all">-전체-</option>
                                    <option name="승인">승인</option>
                                    <option name="대기">대기</option>
                                    <option name="반려">반려</option>
                                </select></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div><br/>

<!-- mainContent의 하단 조회결과 테이블 -->
<div class="mainContent-bottom container-fluid">
    <h4 class="c-grey-900 mT-10 mB-30">Data Tables</h4>
    <div class="row">
        <div class="col-md-12">
            <div class="bgc-white bd bdrs-3 p-20 mB-20">
                <div class="btn_group">
                    <button type="button" class="btn cur-p btn-primary mR-10 btn-right modal-btn test" data-toggle="modal" data-target="#signModal" id="reject">반려</button>
                    <button type="button" class="btn cur-p btn-primary mR-10 btn-right modal-btn test" data-toggle="modal" data-target="#signModal" id="agree">승인</button>
                </div>
                <h5 class="c-grey-900 mB-20">출입신청내역</h5>
                <hr/>
                <table id="applyListTable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                    <thead>
                    <!-- 변수명 변경 및 컬럼 사이즈 조절 필요함 -->
                    <tr>
<!--                        <th style="width: 70px;">No</th>-->
                        <th style="width: 30px;"><input type="checkbox" id="checkall" /></th>
                        <th style="width: 80px;">방문유형</th>
                        <th style="width: 130px;">업체명</th>
                        <th style="width: 230px;">출입신청명</th>
                        <th style="width: 140px;">신청자</th>
                        <th style="width: 100px;">출입자정보</th>
                        <th style="width: 100px;">시작일</th>
                        <th style="width: 100px;">종료일</th>
                        <th style="width: 175px;">신청출입문</th>
                        <th style="width: 120px;">진행단계</th>
                    </tr>
                    </thead>
                    <tbody>
                        {% if applyList.length== 0 %}
                            <td colspan="12" style="text-align:center"><text> 조회된 내역이 없습니다. </text></td>
                        {% else %}
                            <!-- 출입신청마스터에서 작업내역 데이터 출력 부분-->
                            {% for list in applyList %}
                                <tr>
<!--                                    <th style="width: 70px;"></th>-->
                                    <th style="width: 30px;"><input type="checkbox" name="chk" value="{{list.ID}}"/></th>
                                    <th style="width: 80px;">{{list.visit_category}}</th>
                                    <th style="width: 130px;">{{list.sccompinfo.comp_nm}}</th>
                                    <th style="width: 230px;">{{list.visit_purpose}}</th>
                                    <th style="width: 140px;">{{list.applicant}}</th>
                                    <!--작업번호로 출입자 명단 호출 링크-->
                                    <th style="width: 100px; text-decoration: underline;" data-toggle="modal" data-target="#visitantDocModal" id="guestInfo" value="{{list.ID}}">출입자정보</th>
                                    <th style="width: 100px;">{{list.visit_sdate}}</th>
                                    <th style="width: 100px;">{{list.visit_edate}}</th>
                                    <!--방문 사업장 GATE 정보-->
                                    <th style="width: 175px;">{{list.site_nm}}</th>
                                    <th style="width: 120px;">{{list.approval_state}}</th>
                                </tr>
                            <!-- 데이터 출력 끝 -->
                            {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
                <div class="pagination-nav">
                   {{ func.render_pagination('super_approval.index', pagination, id=None, query_string=query_string) }}
                </div>
            </div>
        </div>
    </div>
</div>

<!--방문자의 증빙 상세 내역 확인 Modal Div-->
<div id="visitantDocModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog"
     aria-labelledby="classInfo" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"> 출입자 상세 정보 </h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> ×</button>
            </div>
            <div class="modal-body">
                <table id="classTable" class="table table-bordered">
                    <thead class="thead-light">
                    <tr>
                        <th>No</th>
                        <th>방문자</th>
                        <th>유형</th>
                        <th>유효기간</th>
                        <th>등록일</th>
                        <th>증빙내역</th>
                        <th>상태</th>
                    </tr>
                    </thead>
                    <tbody>
<!--                    <tr>-->
<!--                        <td>1</td>-->
<!--                        <td>특수검진</td>-->
<!--                        <td>유형</td>-->
<!--                        <td>유효기간</td>-->
<!--                        <td>등록일</td>-->
<!--                        <td>첨부파일</td>-->
<!--                        <td>유효</td>-->
<!--                    </tr>-->
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal"> 취소</button>
            </div>
        </div>
    </div>
</div>

<!--승인 및 반려 Modal Div-->
<div id="signModal" class="modal fade bs-example-modal-md" tabindex="-1" role="dialog" aria-labelledby="classInfo" aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
          <h4 class="modal-title"> 출입신청내역 결재</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> × </button>
      </div>
      <div class="modal-body">
          총 <span class="chkCnt">0</span>건의 신청내역을 <span class="appr-name"></span> 하시겠습니까?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="okBtn" value="okBtn" > 확인 </button>
        <button type="button" class="btn btn-primary" data-dismiss="modal"> 취소 </button>
      </div>
    </div>
  </div>
</div>

{% endblock %}